homeassistant:
  name: Home
  latitude: !secret home_lat
  longitude: !secret home_long
  elevation: 193
  unit_system: imperial
  time_zone: America/Chicago

# Enables the frontend
frontend:

http:
  # Login password
   api_password: !secret http_password

# Checks for available updates
updater:

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:

# View all events in a logbook
logbook:

# Track the sun
sun:

# Weather Prediction
sensor:
  - platform: darksky
    api_key: !secret darksky_api_key
    monitored_conditions:
      - summary
#      - icon
#      - nearest_storm_distance
#      - nearest_storm_bearing
#      - precip_type
#      - precip_intensity
#     - precip_probability
      - temperature
#      - apparent_temperature
#      - dew_point
#      - wind_speed
#      - wind_bearing
#      - cloud_cover
#      - humidity
#      - pressure
#      - visibility
#      - ozone
#      - minutely_summary
#      - hourly_summary
#      - daily_summary
#      - temperature_max
#      - temperature_min
#      - apparent_temperature_max
#      - apparent_temperature_min
#      - precip_intensity_max

# Travel Time sensors
#  - platform: google_travel_time
#    name: !secret travel_sensor_1
#    api_key: !secret google_distance_api_key
#    origin: !secret device_1
#    destination: !secret zone_2_id
#  - platform: google_travel_time
#    name: !secret travel_sensor_2
#    api_key: !secret google_distance_api_key
#    origin: !secret device_2
#    destination: !secret zone_3_id
  - platform: google_travel_time
    name: !secret travel_sensor_3
    api_key: !secret google_distance_api_key
    origin: !secret device_1
    destination: zone.home
  - platform: google_travel_time
    name: !secret travel_sensor_4
    api_key: !secret google_distance_api_key
    origin: !secret device_2
    destination: zone.home
#  - platform: google_travel_time
#    name: !secret travel_sensor_5
#    api_key: !secret google_distance_api_key
#    origin: !secret device_1
#    destination: !secret device_2


# Text to speech
tts:
  platform: google

# Thermostat
ecobee:
  api_key: !secret ecobee_api_key

# Location tracking broker
mqtt:
  broker: !secret mosquitto_broker
  port: !secret mosquitto_port
  client_id: !secret mosquitto_client_id
  username: !secret mosquitto_username
  password: !secret mosquitto_password

zone: !include zones.yaml

#device_tracker: !include device_tracker.yaml
device_tracker:
  - platform: owntracks
# Sends notifications
notify:
  - name: pushbullet
    platform: pushbullet
    api_key: !secret pushbullet_api_key

automation:
  - alias: "Startup Notification"
    trigger:
      platform: event
      event_type: homeassistant_start
    action:
      service: notify.pushbullet
      data:
        title: "Alert"
        message: "Home Assistant restarted"
  - alias: "Away Thermostat"
    trigger:
      - platform: numeric_state
        entity_id: !secret travel_sensor_id_3
        above: '15'
      - platform: numeric_state
        entity_id: !secret travel_sensor_id_4
        above: '15'
    condition:
      condition: and
      conditions:
      - condition: numeric_state
        entity_id: !secret travel_sensor_id_3
        above: '15'
      - condition: numeric_state
        entity_id: !secret travel_sensor_id_4
        above: '15'
    action:
      - service: climate.set_away_mode
        data:
          away_mode: true
      - service: notify.pushbullet
        data:
          title: "Alert"
          message: "Thermostat set to Away"
  - alias: "Home Thermostat"
    trigger:
      - platform: numeric_state
        entity_id: !secret travel_sensor_id_3
        below: '15'
      - platform: numeric_state
        entity_id: !secret travel_sensor_id_4
        below: '15'
    condition:
      condition: or
      conditions:
      - condition: numeric_state
        entity_id: !secret travel_sensor_id_3
        below: '15'
      - condition: numeric_state
        entity_id: !secret travel_sensor_id_4
        below: '15'
    action:
      - service: climate.set_away_mode
        data:
          away_mode: false
      - service: notify.pushbullet
        data:
          title: "Alert"
          message: "Thermostat set to Home"

  - alias: "Daily Restart"
    trigger:
      platform: time
      hours: 1
      minutes: 0
      seconds: 0
    action:
      service: homeassistant.restart